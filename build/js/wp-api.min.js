!function(a){"use strict";var b="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","backbone","exports"],function(c,d,e,f){b.Backbone=a(b,f,c,d,e)});else if("undefined"!=typeof exports){var c=require("underscore"),d=require("jquery"),e=require("backbone");a(b,exports,c,d,e)}else b.Backbone=a(b,{},b._,b.jQuery||b.Zepto||b.ender||b.$,b.Backbone)}(function(a,b,c,d,e){var f;return"undefined"==typeof a.wpApiSettings&&(f=a.wpApiSettings={}),function(a,b,c){"use strict";function d(){this.models={},this.collections={},this.views={}}a.wp=b||{},b.api=b.api||new d,b.api.versionString=b.api.versionString||"wp/v2/"}(a,b),function(a,d){"use strict";var e,f;a.wp=a.wp||{},b.api=b.api||{},b.api.utils=b.api.utils||{},Date.prototype.toISOString||(e=function(a){return f=String(a),1===f.length&&(f="0"+f),f},Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}),b.api.utils.parseISO8601=function(a){var b,c,e,f,g=0,h=[1,4,5,6,7,10,11];if(c=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(a)){for(e=0;f=h[e];++e)c[f]=+c[f]||0;c[2]=(+c[2]||1)-1,c[3]=+c[3]||1,"Z"!==c[8]&&d!==c[9]&&(g=60*c[10]+c[11],"+"===c[9]&&(g=0-g)),b=Date.UTC(c[1],c[2],c[3],c[4],c[5]+g,c[6],c[7])}else b=Date.parse?Date.parse(a):NaN;return b},b.api.utils.getRootUrl=function(){return a.location.origin?a.location.origin+"/":a.location.protocol+"/"+a.location.host+"/"},b.api.utils.capitalize=function(a){return c.isUndefined(a)?a:a.charAt(0).toUpperCase()+a.slice(1)},b.api.utils.extractRoutePart=function(a,d){var e;return d=d||1,a=a.replace(b.api.versionString,""),e=a.split("/").reverse(),c.isUndefined(e[--d])?"":e[d]},b.api.utils.extractParentName=function(a){var b,c=a.lastIndexOf("_id>[\\d]+)/");return 0>c?"":(b=a.substr(0,c-1),b=b.split("/"),b.pop(),b=b.pop())}}(a),function(a,b,d,e,f){"use strict";a.api.WPApiBaseModel=d.Model.extend({sync:function(a,e,f){var g;return f=f||{},c.isUndefined(b.nonce)||c.isNull(b.nonce)||(g=f.beforeSend,f.beforeSend=function(a){return a.setRequestHeader("X-WP-Nonce",b.nonce),g?g.apply(this,arguments):void 0}),d.sync(a,e,f)},save:function(a,b){return c.contains(this.methods,"PUT")||c.contains(this.methods,"POST")?d.Model.prototype.save.call(this,a,b):!1},destroy:function(a){return c.contains(this.methods,"DELETE")?d.Model.prototype.destroy.call(this,a):!1}}),a.api.models.Schema=a.api.WPApiBaseModel.extend({url:function(){return b.root+a.api.versionString}})}(b,f,e,a),function(a,b,c,d,e,f){"use strict";a.api.WPApiBaseCollection=c.Collection.extend({initialize:function(a,b){this.state={data:{},currentPage:null,totalPages:null,totalObjects:null},d.isUndefined(b)?this.parent="":this.parent=b.parent},sync:function(a,e,f){var g,h,i=this;return f=f||{},g=f.beforeSend,"undefined"!=typeof b.nonce&&(f.beforeSend=function(a){return a.setRequestHeader("X-WP-Nonce",b.nonce),g?g.apply(i,arguments):void 0}),"read"===a&&(f.data?(i.state.data=d.clone(f.data),delete i.state.data.page):i.state.data=f.data={},"undefined"==typeof f.data.page?(i.state.currentPage=null,i.state.totalPages=null,i.state.totalObjects=null):i.state.currentPage=f.data.page-1,h=f.success,f.success=function(a,b,c){return i.state.totalPages=parseInt(c.getResponseHeader("x-wp-totalpages"),10),i.state.totalObjects=parseInt(c.getResponseHeader("x-wp-total"),10),null===i.state.currentPage?i.state.currentPage=1:i.state.currentPage++,h?h.apply(this,arguments):void 0}),c.sync(a,e,f)},more:function(a){if(a=a||{},a.data=a.data||{},d.extend(a.data,this.state.data),"undefined"==typeof a.data.page){if(!this.hasMore())return!1;null===this.state.currentPage||this.state.currentPage<=1?a.data.page=2:a.data.page=this.state.currentPage+1}return this.fetch(a)},hasMore:function(){return null===this.state.totalPages||null===this.state.totalObjects||null===this.state.currentPage?null:this.state.currentPage<this.state.totalPages}})}(b,f,e,c,a),function(a,d,g){"use strict";var h;a.wp=a.wp||{},b.api=b.api||{},b.api.init=function(a,e){var g,h;return b.api.apiRoot=a||f.root,b.api.versionString=e||b.api.versionString,f.root=b.api.apiRoot,h=new d.Deferred,!c.isUndefined(sessionStorage)&&sessionStorage.getItem("wp-api-schema-model"+a)?(g=new b.api.models.Schema(JSON.parse(sessionStorage.getItem("wp-api-schema-model"+a))),b.api.constructFromSchema(g,h)):(g=new b.api.models.Schema,g.fetch({success:function(d){c.isUndefined(sessionStorage)||sessionStorage.setItem("wp-api-schema-model"+a,JSON.stringify(d)),b.api.constructFromSchema(d,h)},error:function(){}})),h.promise()},b.api.constructFromSchema=function(a,d){var e=[],f=[],g=b.api.apiRoot.replace(b.api.utils.getRootUrl(),""),h={};h.models={},h.collections={},c.each(a.get("routes"),function(a,c){c!==b.api.versionString&&c!==g&&c!=="/"+b.api.versionString.slice(0,-1)&&(c.endsWith("+)")?e.push({index:c,route:a}):c.endsWith("me")||f.push({index:c,route:a}))}),c.each(e,function(a){var d,e=b.api.utils.extractRoutePart(a.index,2),f=b.api.utils.extractRoutePart(a.index,4);""!==f&&f!==e?(d=b.api.utils.capitalize(f)+b.api.utils.capitalize(e),h.models[d]=b.api.WPApiBaseModel.extend({url:function(){var a=b.api.apiRoot+b.api.versionString+f+"/"+this.get("parent")+"/"+e;return c.isUndefined(this.get("id"))||(a+="/"+this.get("id")),a},route:a,methods:a.route.methods})):(d=b.api.utils.capitalize(e),h.models[d]=b.api.WPApiBaseModel.extend({url:function(){var a=b.api.apiRoot+b.api.versionString+e;return c.isUndefined(this.get("id"))||(a+="/"+this.get("id")),a},route:a,methods:a.route.methods})),b.api.decorateFromRoute(a.route.endpoints,h.models[d])}),c.each(f,function(a){var c,d=a.index.slice(a.index.lastIndexOf("/")+1),e=b.api.utils.extractRoutePart(a.index,4);""!==e&&e!==d?(c=b.api.utils.capitalize(e)+b.api.utils.capitalize(d),h.collections[c]=b.api.WPApiBaseCollection.extend({url:function(){return b.api.apiRoot+b.api.versionString+e+"/"+this.parent+"/"+d},model:h.models[c],route:a,methods:a.route.methods})):(c=b.api.utils.capitalize(d),h.collections[c]=b.api.WPApiBaseCollection.extend({url:b.api.apiRoot+b.api.versionString+d,route:a,methods:a.route.methods})),b.api.decorateFromRoute(a.route.endpoints,h.collections[c])}),c.defer(function(){d.resolve(h)})},b.api.decorateFromRoute=function(a,b){c.each(a,function(a){c.contains(a.methods,"POST")||c.contains(a.methods,"PUT")?c.isEmpty(a.args)||(c.isEmpty(b.defaults)?b.defaults=a.args:b.defaults=c.union(a.args,b.defaults)):c.contains(a.methods,"GET")&&(c.isEmpty(a.args)||(c.isEmpty(b.options)?b.options=a.args:b.options=c.union(a.args,b.options)))}),c.each(b.defaults,function(a,d){c.isUndefined(a["default"])?b.defaults[d]=null:b.defaults[d]=a["default"]})},b.api.endpoints=new e.Collection,h=b.api.init(),h.done(function(a){b.api.models=c.extend(a.models,b.api.models),b.api.collections=c.extend(a.collections,b.api.collections),b.api.endpoints.push(a)})}(a,d),a.wp});
//# sourceMappingURL=wp-api.min.map