!function(a){"use strict";var b="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(c,d,e){b.Backbone=a(b,e,c,d)});else if("undefined"!=typeof exports){var c,d=require("underscore");try{c=require("jquery")}catch(e){}a(b,exports,d,c)}else b.Backbone=a(b,{},b._,b.jQuery||b.Zepto||b.ender||b.$)}(function(a,b,c,d){return function(a,b){"use strict";function c(){this.models={},this.collections={},this.views={}}a.wp=a.wp||{},wp.api=wp.api||new c,wp.api.versionString=wp.api.versionString||"wp/v2/"}(a),function(a,b){"use strict";var d,e;a.wp=a.wp||{},wp.api=wp.api||{},wp.api.utils=wp.api.utils||{},Date.prototype.toISOString||(d=function(a){return e=String(a),1===e.length&&(e="0"+e),e},Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+d(this.getUTCMonth()+1)+"-"+d(this.getUTCDate())+"T"+d(this.getUTCHours())+":"+d(this.getUTCMinutes())+":"+d(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}),wp.api.utils.parseISO8601=function(a){var c,d,e,f,g=0,h=[1,4,5,6,7,10,11];if(d=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(a)){for(e=0;f=h[e];++e)d[f]=+d[f]||0;d[2]=(+d[2]||1)-1,d[3]=+d[3]||1,"Z"!==d[8]&&b!==d[9]&&(g=60*d[10]+d[11],"+"===d[9]&&(g=0-g)),c=Date.UTC(d[1],d[2],d[3],d[4],d[5]+g,d[6],d[7])}else c=Date.parse?Date.parse(a):NaN;return c},wp.api.utils.getRootUrl=function(){return a.location.origin?a.location.origin+"/":a.location.protocol+"/"+a.location.host+"/"},wp.api.utils.capitalize=function(a){return c.isUndefined(a)?a:a.charAt(0).toUpperCase()+a.slice(1)},wp.api.utils.extractRoutePart=function(a,b){var d;return b=b||1,a=a.replace(wp.api.versionString,""),d=a.split("/").reverse(),c.isUndefined(d[--b])?"":d[b]},wp.api.utils.extractParentName=function(a){var b,c=a.lastIndexOf("_id>[\\d]+)/");return 0>c?"":(b=a.substr(0,c-1),b=b.split("/"),b.pop(),b=b.pop())}}(a),function(a,b,d,e,f){"use strict";a.api.WPApiBaseModel=d.Model.extend({sync:function(a,e,f){var g;return f=f||{},c.isUndefined(b.nonce)||c.isNull(b.nonce)||(g=f.beforeSend,f.beforeSend=function(a){return a.setRequestHeader("X-WP-Nonce",b.nonce),g?g.apply(this,arguments):void 0}),d.sync(a,e,f)},save:function(a,b){return c.contains(this.methods,"PUT")||c.contains(this.methods,"POST")?d.Model.prototype.save.call(this,a,b):!1},destroy:function(a){return c.contains(this.methods,"DELETE")?d.Model.prototype.destroy.call(this,a):!1}}),a.api.models.Schema=a.api.WPApiBaseModel.extend({url:function(){return b.root+a.api.versionString}})}(wp,wpApiSettings,b,a),function(a,b,c,d,e,f){"use strict";a.api.WPApiBaseCollection=c.Collection.extend({initialize:function(a,b){this.state={data:{},currentPage:null,totalPages:null,totalObjects:null},d.isUndefined(b)?this.parent="":this.parent=b.parent},sync:function(a,e,f){var g,h,i=this;return f=f||{},g=f.beforeSend,"undefined"!=typeof b.nonce&&(f.beforeSend=function(a){return a.setRequestHeader("X-WP-Nonce",b.nonce),g?g.apply(i,arguments):void 0}),"read"===a&&(f.data?(i.state.data=d.clone(f.data),delete i.state.data.page):i.state.data=f.data={},"undefined"==typeof f.data.page?(i.state.currentPage=null,i.state.totalPages=null,i.state.totalObjects=null):i.state.currentPage=f.data.page-1,h=f.success,f.success=function(a,b,c){return i.state.totalPages=parseInt(c.getResponseHeader("x-wp-totalpages"),10),i.state.totalObjects=parseInt(c.getResponseHeader("x-wp-total"),10),null===i.state.currentPage?i.state.currentPage=1:i.state.currentPage++,h?h.apply(this,arguments):void 0}),c.sync(a,e,f)},more:function(a){if(a=a||{},a.data=a.data||{},d.extend(a.data,this.state.data),"undefined"==typeof a.data.page){if(!this.hasMore())return!1;null===this.state.currentPage||this.state.currentPage<=1?a.data.page=2:a.data.page=this.state.currentPage+1}return this.fetch(a)},hasMore:function(){return null===this.state.totalPages||null===this.state.totalObjects||null===this.state.currentPage?null:this.state.currentPage<this.state.totalPages}})}(wp,wpApiSettings,b,c,a),function(a,d){"use strict";var e;a.wp=a.wp||{},wp.api=wp.api||{},wp.api.init=function(a,b){var d,e;return wp.api.apiRoot=a||wpApiSettings.root,wp.api.versionString=b||wp.api.versionString,wpApiSettings.root=wp.api.apiRoot,e=new jQuery.Deferred,!c.isUndefined(sessionStorage)&&sessionStorage.getItem("wp-api-schema-model"+a)?(d=new wp.api.models.Schema(JSON.parse(sessionStorage.getItem("wp-api-schema-model"+a))),wp.api.constructFromSchema(d,e)):(d=new wp.api.models.Schema,d.fetch({success:function(b){c.isUndefined(sessionStorage)||sessionStorage.setItem("wp-api-schema-model"+a,JSON.stringify(b)),wp.api.constructFromSchema(b,e)},error:function(){}})),e.promise()},wp.api.constructFromSchema=function(a,b){var d=[],e=[],f=wp.api.apiRoot.replace(wp.api.utils.getRootUrl(),""),g={};g.models={},g.collections={},c.each(a.get("routes"),function(a,b){b!==wp.api.versionString&&b!==f&&b!=="/"+wp.api.versionString.slice(0,-1)&&(b.endsWith("+)")?d.push({index:b,route:a}):b.endsWith("me")||e.push({index:b,route:a}))}),c.each(d,function(a){var b,d=wp.api.utils.extractRoutePart(a.index,2),e=wp.api.utils.extractRoutePart(a.index,4);""!==e&&e!==d?(b=wp.api.utils.capitalize(e)+wp.api.utils.capitalize(d),g.models[b]=wp.api.WPApiBaseModel.extend({url:function(){var a=wp.api.apiRoot+wp.api.versionString+e+"/"+this.get("parent")+"/"+d;return c.isUndefined(this.get("id"))||(a+="/"+this.get("id")),a},route:a,methods:a.route.methods})):(b=wp.api.utils.capitalize(d),g.models[b]=wp.api.WPApiBaseModel.extend({url:function(){var a=wp.api.apiRoot+wp.api.versionString+d;return c.isUndefined(this.get("id"))||(a+="/"+this.get("id")),a},route:a,methods:a.route.methods})),wp.api.decorateFromRoute(a.route.endpoints,g.models[b])}),c.each(e,function(a){var b,c=a.index.slice(a.index.lastIndexOf("/")+1),d=wp.api.utils.extractRoutePart(a.index,4);""!==d&&d!==c?(b=wp.api.utils.capitalize(d)+wp.api.utils.capitalize(c),g.collections[b]=wp.api.WPApiBaseCollection.extend({url:function(){return wp.api.apiRoot+wp.api.versionString+d+"/"+this.parent+"/"+c},model:g.models[b],route:a,methods:a.route.methods})):(b=wp.api.utils.capitalize(c),g.collections[b]=wp.api.WPApiBaseCollection.extend({url:wp.api.apiRoot+wp.api.versionString+c,route:a,methods:a.route.methods})),wp.api.decorateFromRoute(a.route.endpoints,g.collections[b])}),c.defer(function(){b.resolve(g)})},wp.api.decorateFromRoute=function(a,b){c.each(a,function(a){c.contains(a.methods,"POST")||c.contains(a.methods,"PUT")?c.isEmpty(a.args)||(c.isEmpty(b.defaults)?b.defaults=a.args:b.defaults=c.union(a.args,b.defaults)):c.contains(a.methods,"GET")&&(c.isEmpty(a.args)||(c.isEmpty(b.options)?b.options=a.args:b.options=c.union(a.args,b.options)))}),c.each(b.defaults,function(a,d){c.isUndefined(a["default"])?b.defaults[d]=null:b.defaults[d]=a["default"]})},wp.api.endpoints=new b.Collection,e=wp.api.init(),e.done(function(a){wp.api.models=c.extend(a.models,wp.api.models),wp.api.collections=c.extend(a.collections,wp.api.collections),wp.api.endpoints.push(a)})}(a),a.wp});
//# sourceMappingURL=wp-api.min.map